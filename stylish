#!/usr/bin/env php
<?php

require 'require.php';

Reporter::shout(Reporter::MSG_START);

// first argument is the script's name: "stylish", remove this
array_shift($argv);

// the command to execute should be the first thing
$command = $argv[0];

// and we feed each command its own name, so directives are = argument string
$directives = $argv;

// each command should detect if its been called...
$watch = WatchCommand::detect($command);
$list = ListCommand::detect($command);
$stop = StopCommand::detect($command);
$shutdown = ShutdownCommand::detect($command);

$help = HelpDirective::detect($command);

// and then go through and perform approriate operations
if ($watch) {
	$watch = new WatchCommand($directives);
	$watch->execute();
} else if ($list) {
	$list = new ListCommand($directives);
	$list->execute();
} else if ($stop) {
	$stop = new StopCommand($directives);
	$stop->execute();
} else if ($shutdown) {
	$shutdown = new ShutdownCommand($shutdown);
	$shutdown->execute();
} else if ($help) {
	Reporter::shout("Stylish SASS v0.0.1\nCreates, kills, tracks and otherwise manages SASS processes.\n\n\tCommands:\n\n\twatch\t\t\t\tStart a SASS process\n\t\tArguments:\n\t\t-n --name\t\tName the process\n\t\t{input}:{output}\t{input} is the input SASS file\n\t\t\t\t\t{output} is the compiled CSS\n\t\t-c --compressed\t\tOutput minified CSS (Optional)\n\n\tlist\t\t\t\tList all SASS processes\n\tstop\t\t\t\tstop a SASS process\n\t\tArguments:\n\t\t{pid}\t\t\tProcess ID to kill\n\n\t-h --help\t\t\t\tDisplay this help dialogue");
} else {
	Reporter::shout(Reporter::MSG_UNRECOGNIZED_COMMAND);
}
